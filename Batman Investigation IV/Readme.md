# Batman Investigation IV - The Last J0ke
## Difficulty: `Hard`

```

▄▄▄█████▓ ██░ ██ ▓█████     ██▓    ▄▄▄        ██████ ▄▄▄█████▓    ▄▄▄██▀▀▀▒█████   ██ ▄█▀▓█████ 
▓  ██▒ ▓▒▓██░ ██▒▓█   ▀    ▓██▒   ▒████▄    ▒██    ▒ ▓  ██▒ ▓▒      ▒██  ▒██▒  ██▒ ██▄█▒ ▓█   ▀ 
▒ ▓██░ ▒░▒██▀▀██░▒███      ▒██░   ▒██  ▀█▄  ░ ▓██▄   ▒ ▓██░ ▒░      ░██  ▒██░  ██▒▓███▄░ ▒███   
░ ▓██▓ ░ ░▓█ ░██ ▒▓█  ▄    ▒██░   ░██▄▄▄▄██   ▒   ██▒░ ▓██▓ ░    ▓██▄██▓ ▒██   ██░▓██ █▄ ▒▓█  ▄ 
  ▒██▒ ░ ░▓█▒░██▓░▒████▒   ░██████▒▓█   ▓██▒▒██████▒▒  ▒██▒ ░     ▓███▒  ░ ████▓▒░▒██▒ █▄░▒████▒
  ▒ ░░    ▒ ░░▒░▒░░ ▒░ ░   ░ ▒░▓  ░▒▒   ▓▒█░▒ ▒▓▒ ▒ ░  ▒ ░░       ▒▓▒▒░  ░ ▒░▒░▒░ ▒ ▒▒ ▓▒░░ ▒░ ░
    ░     ▒ ░▒░ ░ ░ ░  ░   ░ ░ ▒  ░ ▒   ▒▒ ░░ ░▒  ░ ░    ░        ▒ ░▒░    ░ ▒ ▒░ ░ ░▒ ▒░ ░ ░  ░
  ░       ░  ░░ ░   ░        ░ ░    ░   ▒   ░  ░  ░    ░          ░ ░ ░  ░ ░ ░ ▒  ░ ░░ ░    ░   
          ░  ░  ░   ░  ░       ░  ░     ░  ░      ░               ░   ░      ░ ░  ░  ░      ░  ░
```

## Description
Bruce Wayne was alerted that Joker have escaped from Arkham Asylum, Joker with all the Gotham outlaws crafts a letter for Bruce, He wants to make it go all crazy x_0!,and now Batman gets a message sent to Him with a letter, but apparently as Damain was in the Desktop, he opens it and everything goes crazy, the letter is now distributed to everyone in gotham, if Batman doesn't find a fix, There is no stopping the chaos. Can you help Batman fix the Pademonium? 


`File Password : L1>l:p7!7h4[D23^iZ&)`

## Handout
+ [Primary Link](https://www.dropbox.com/scl/fi/rrru18br1a1c8nk4hownm/challf1le.zip?rlkey=x3kxgmhlmkhrfrrojiop43qd8&dl=0)
+ [Mirror Link - Mega](https://mega.nz/file/Ya9SWSDY#gqKgvUy2YxUdcTaRVdkv7K4J410-XXodWbZYF5nBOnY)
+ [Mirror Link](https://amritauniv-my.sharepoint.com/:u:/g/personal/inctfj_am_amrita_edu/EZdCwdTgK79No909OKYpHfEB1G_bTJYV007oWg8_FbdK3A)

`Flag format: bi0sctf{...}`

## Author
- [Azr43lKn1ght](https://twitter.com/Azr43lKn1ght)
- [jl_24](https://twitter.com/j0hith)
- [sp3p3x](https://twitter.com/sp3p3x)
- [gh0stkn1ght](https://twitter.com/mspr75)

### Questions

you can either directly answer it or you can solve the challenge by running main.py in Solution folder and answering it.

```
Q1) What is the day and time that the infection was started?
Format: yyyy:mm:dd_hh:mm

Q2) There are encrypted files, what is the algorithm used to encrypt them and what files store the decryption vectors?
Format: algorithm-used_filename

Q3) what is the file that initialsed the infection?
Format: filename_md5(file)

Q4) what is the file that further spreads the infection and what is it packed with?
Format: filename_md5(file)_packer-name(all-lowercase)

Q5) Given a string TH8r463H0D8O0C6enNPC, use the same algorithm of the above file that it used on the urls and give the hash?
Format: md5(answer)

Q6) How is the further spreading done, give the technique, the file that does it and file that does further infection?
Format: malware-technique(all-lowercase)_md5(file-that-does-it)_md5(file-that-does-further-infection)

Q7) What all files are dropped by the infector?
Format: md5(files) seperated by underscores

Q8) Where is the credit card information that gets stolen sent (isn't the cat cute?)?
Format: ip:port

Q9) What is the file that had to set up persistence and what is the secret string that does through encryption?
Format: filename_md5(file)_md5(decrypted-secret-string)

Q10) What is the C2 framework used, and what is the file name of the executable, what is the sleep technique used?
Format: C2-framework(all-lowercase)_executable-name_sleep-technique(case-sensitive)
```

### Solution

The solution as well as the flag can be found in the same folder, but it's advised to finish all the questions before checking the solution.

### Contact

[Azr43lKn1ght](https://twitter.com/Azr43lKn1ght)

Chief Maintainer and Author

DFIR Labs