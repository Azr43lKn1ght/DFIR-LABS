# Batman Investigation VI - Death To Azrael - Bring Me Down!
## Difficulty: `Insane`

```

██████╗ ███████╗ █████╗ ████████╗██╗  ██╗    ████████╗ ██████╗      █████╗ ███████╗██████╗  █████╗ ███████╗██╗     
██╔══██╗██╔════╝██╔══██╗╚══██╔══╝██║  ██║    ╚══██╔══╝██╔═══██╗    ██╔══██╗╚══███╔╝██╔══██╗██╔══██╗██╔════╝██║     
██║  ██║█████╗  ███████║   ██║   ███████║       ██║   ██║   ██║    ███████║  ███╔╝ ██████╔╝███████║█████╗  ██║     
██║  ██║██╔══╝  ██╔══██║   ██║   ██╔══██║       ██║   ██║   ██║    ██╔══██║ ███╔╝  ██╔══██╗██╔══██║██╔══╝  ██║     
██████╔╝███████╗██║  ██║   ██║   ██║  ██║       ██║   ╚██████╔╝    ██║  ██║███████╗██║  ██║██║  ██║███████╗███████╗
╚═════╝ ╚══════╝╚═╝  ╚═╝   ╚═╝   ╚═╝  ╚═╝       ╚═╝    ╚═════╝     ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝     

```

## Description

```

Jean Paul: "Cruz's last location is this underground sewers, this is same place Alan Wayne was found dead naked decades ago!"
Jason Todd: "Don't make a move Jean, Bruce is not around, we need to handle this better, retreat, your signal is getting weaker"
Jean Paul: "I can't let Cruz down like this, I have to save her, she wants us to save her, I feel something is wrong, I have to go in, I haven't got a choice! If anything happens to Jessica Cruz, Azrael will take me over!"
Jason Todd: "Jean, I exactly know what it's to wait for someone to save you,until the last moment of Joker 's torture I had the hope of Bruce saving me, thanks to lazarus for the life I live now!"
Jean Paul: "Jason, The green lantern corps can't contact her with her ring, I am very concerned, she saved me from the monster I was!"
Jason Todd: "Enough of your personality split up, This is serious, retreat right now!"
Jean Paul: "What do you know about him?, Azrael is not an alter ego, split personality or a mental identity, Azrael is a demon, he calls himself the angel of vengence, death or whatsoever, He is a monster trained by the order! He killed bane, the same man who broke Batman's back, Cruz helped me bury him, It's a flogging dead horse without her!"
Jason Todd: "Jean, mate I know you are him, so please retreat!"
Jean Paul: "I aaaaammmmm ssssooooooo........"
Jason Todd: "Jean!! The signal is gone for god's sake!"

** Jean Paul falls through a hole in the ground **
** Jean wakes up screaming -- Surrounded by Talons**

Jean Paul: "Who are you?"
Talon removes his mask, Jean looks at a kent face
Talon: "Hello Azrael, don't you recognize me?..... well I am Thomas.....Thomas Wayne Jr.!"
Jean Paul: "What? How is this possible? You are not Bruce's father!"
Thomas Wayne: "Do I look that old? I am Bruce's brother, I was an infant when my parents died, I grew up with the owls, they taught me what the purpose of life is."
Jean Paul: "Where is Jessica Cruz?, Why is my vision becoming blurry? what are these illusions?"
Thomas Wayne: "Welcome to the Courtttt!!"

** Jean goes through a series of illusions, he sees his past, his present and his future, he sees the death of Jessica Cruz, he sees himself killing her, he sees himself killing Batman, he sees himself killing the entire bat family, he has visions of fighting with the owls, he sees himself becoming the monster he was, he has conversations with Azrael, he sees talons killing Cruz and he is helpless! he is back obeying St Dumas and executing their assasinations **

Jean Paul: "Enough of this, which is real and which is not, I got wounds and fighting for days and you try to hurt me as mentally as possible?, I can't do this anymore with cowards like you! Call yourself court of Camelions, you are nothing but a bunch of cowards hiding under the city!"

** Group of talons jump surrounding Jean Paul, Tired Helpless Jean finally gives up and takes the last resort **

Jean yells : "Azrael, it's time..."

** The Bat familiy arrives at the scene, they see Jean in the ground, fainted with blood all around him, they see many talons laying dead, faces butchered, multiple sword cuts... Jean wakes up! **

Jean Paul: "aghhhhh.....Did he make it? was it worth it? did he win?"
Bruce Wayne: "Azrael?, if so he sent us a wonky file and what ever necessary to decrypt it further, he made sure no one gets the information about the court of owls, with that we can bring them down, he mentionmed the court already infected you phone with a malware, we need the last hash to get all their locations and operations down!"
Jean Paul: "I don't remeber anything bruce, but i can't feel him trying to take over me anymore, did he see something that I shouldn't?, did he kill himself?, We need to get this done!"
Dick Grayson: "Azrael sent a message , it was "take care of Jean, I won't be around!"
David Zavimbe: "Let's end this owls first, we don't have more time, with this scene here, they will already be on their next plan!"
Bruce Wayne: "I will get the hellbat, I will hunt them down, you guys finish the job, Jason! Tim! Duke! with me!"

```

**MD5 Hash: 40d3c031964b7e796983abf7c338be7c**

**Evidence File Password: `M47:MT7b3rVoCwZ6%jO2` **

## Handout
- [Primary Link](https://drive.google.com/file/d/1vqeTdoAFzHklcoEKI-akEEApZ9Iq4a_f/view?usp=sharing)
- [Mirror Link](https://mega.nz/file/ydE01KBS#1uz8HQoExCKB9qQl0sZ3Qyx_mWbB7t3NRG-gk1gkLjQ)

### Questions

you can either directly answer it or you can solve the challenge by running main.py in Solution folder and answering it.

```
Q1) What is th pid of netd service and inode of the file rt_tables and laberl for its routing table number 1010?
Format: pid-inode-label

Q2) What is the inode, content encryption mode(int), name encryption mode(int) of DCIM folder?
Format: inode-contentmode(int)-filenamemode(int)

Q3) What is the folder modified UTC time(yyyy-mm-dd_hh:mm:ss), File based encryption key descriptor(hex) and nonce(hex) of DCIM folder (hex all caps no space)?
Format: time(yyyy-mm-dd_hh:mm:ss)-keydescriptor(hex)-nonce(hex)

Q4) give all the File Based Encryption masterkeys in the order of most hits
Format: descriptor1keypart1:descriptor1keypart2-descriptor2keypart1:descriptor2keypart2-....

Q5) what is the Derived Encryption Key(DEK) after Key Decryption function for decryption of DCIM folder name?
Format: key(hex)

Q6) Which are/is the unedited image file(s) in the DCIM folder? also give md5sum of the file(s).
Format: name1_md5sum1-name2_md5sum2-...

Q7) What is the 7th tweak value passed as IV for decryption of the above mentioned file's content decryption?
Format: tweak(hex)

Q8) What is the saved contact name, number and email address?
Format: name_number(only numbers)_email

Q9) What is the important message code sent to the contact?
Format: code

Q10) What is the private messenger used, its database decryption key and user address?
Format: messenger(primary name only)-decryptionkey(hex)-address

Q11) What is the user address who was contacted in the private messenger and what was the important code sent?
Format: address_code

Q12) What is the first and second visited sites in browser(add https and omit the last '/' and google)?
Format: site1-site2

Q13) What is the malware package name and its apk md5 hash?
Format: packagename(com.example.malware)-md5(apk)

Q14) Identify malware family label and its version code.
Format: Family.Label-versioncode

Q15) when was the malware installed? time in UTC
Format: time(yyyy-mm-dd_hh:mm:ss)

Q16) What is the malware client name, host, port and key?
Format: clientname-host-port-key

Q17) The attacker made a call from the device. What is the phone number, time and duration of the call?
Format: number-time(yyyy-mm-dd_hh:mm:ss)-duration(seconds)

Q18) what is the name of the dropped ransomware, its md5 hash and when was it installed(time in UTC)?
Format: packagename(com.example.ransomware)_md5hash_time(yyyy-mm-dd_hh:mm:ss)

Q19) what is the ransomware key file name and key?
Format: keyfile(keyfilename)-key

Q20) what is the decrypted hash contained in one of the files (note: The ransomware was run twice, so you need to decrypt the file twice)?
Format: filename-filecontent
```

`Flag format: r3ctf{...}`

## Author
- [Azr43lKn1ght](https://x.com/Azr43lKn1ght)

### Solution

The solution as well as the flag can be found in the same folder, but it's advised to finish all the questions before checking the solution.

### Contact

[Azr43lKn1ght](https://x.com/Azr43lKn1ght)

Chief Maintainer and Author